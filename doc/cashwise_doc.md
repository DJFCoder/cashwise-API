# üìÑ CashWise ‚Äì Documenta√ß√£o do MVP

**Mais controle, menos desperd√≠cio.**

## Sum√°rio

1. [Apresenta√ß√£o](#apresenta√ß√£o)
2. [Descri√ß√£o do Projeto](#descri√ß√£o-do-projeto)
3. [Escopo do MVP](#escopo-do-mvp)
4. [Necessidades e Regras de Neg√≥cio](#necessidades-observadas-e-regras-de-neg√≥cio)
5. [Requisitos Funcionais](#requisitos-funcionais)
6. [Requisitos N√£o Funcionais](#requisitos-n√£o-funcionais)
7. [Diagramas UML](#diagramas-uml)
8. [Estrutura de Pacotes](#estrutura-de-pacotes)

---

## 1. Apresenta√ß√£o

A **Plataforma de Controle Financeiro Pessoal ‚Äì CashWise** √© um sistema web com:
- **Back-end**: Java (Spring Boot) - API REST
- **Front-end**: Bootstrap / Alpine.js / jQuery

**Objetivo**: Registrar e analisar receitas e despesas, com categoriza√ß√£o e relat√≥rios visuais para apoiar decis√µes financeiras pessoais.

---

## 2. Descri√ß√£o do Projeto

O usu√°rio registra lan√ßamentos (receitas/despesas) informando:
- Valor (em Real - BRL)
- Categoria (previamente cadastrada)
- Recorr√™ncia (obrigat√≥ria, entre op√ß√µes fixas do sistema)
- Data (padr√£o: data atual)
- Descri√ß√£o (obrigat√≥ria)

Os dados s√£o exibidos em listagens filtr√°veis e em uma p√°gina de relat√≥rios com dashboards visuais.

---

## 3. Escopo do MVP

- CRUD de **Categorias** (id e nome)
- CRUD de **Lan√ßamentos** (Receita/Despesa) com recorr√™ncia fixa
- Listagem de lan√ßamentos com filtros (per√≠odo, tipo, categoria) e pagina√ß√£o
- P√°gina de **Relat√≥rios** com gr√°ficos:
  - Saldo no per√≠odo
  - Evolu√ß√£o mensal
  - Distribui√ß√£o por categoria

### Observa√ß√µes
- Relat√≥rios visualizados apenas na interface web (sem exporta√ß√£o no MVP)
- Moeda √∫nica: todos os valores em Real (BRL)
- Lan√ßamentos com recorr√™ncia diferente de `UNICA` geram automaticamente lan√ßamentos futuros
- Categorias s√£o compartilhadas entre receitas e despesas (simplifica√ß√£o do MVP)

---

## 4. Necessidades Observadas e Regras de Neg√≥cio

### Necessidades
- Controle unificado de receitas e despesas
- Classifica√ß√£o por categorias
- Relat√≥rios visuais para an√°lise r√°pida da situa√ß√£o financeira

### Regras de Neg√≥cio
- Todo lan√ßamento deve estar vinculado a uma categoria
- Cada lan√ßamento exige: tipo (receita/despesa), valor (> 0), categoria, data (padr√£o: hoje), recorr√™ncia e descri√ß√£o
- Recorr√™ncia √© obrigat√≥ria e fixa: `UNICA`, `DIARIA`, `SEMANAL`, `MENSAL`, `TRIMESTRAL`, `ANUAL`
- A recorr√™ncia √© definida pelo sistema (n√£o personaliz√°vel pelo usu√°rio)
- **Automa√ß√£o de Recorr√™ncia**: Quando a recorr√™ncia for diferente de `UNICA`, o sistema deve gerar automaticamente os pr√≥ximos lan√ßamentos conforme a periodicidade escolhida
- Lan√ßamentos n√£o podem ser editados, apenas exclu√≠dos (regra do MVP)
- **Exclus√£o de Categoria**: Uma categoria s√≥ pode ser exclu√≠da se n√£o houver lan√ßamentos vinculados a ela. O sistema deve validar esta regra antes de permitir a exclus√£o
- Todos os valores monet√°rios s√£o em Real (BRL) no MVP
- Categorias s√£o entidades simples com apenas id e nome, utiliz√°veis tanto para receitas quanto para despesas (compartilhadas no MVP)
- **Valida√ß√µes**: Todas as valida√ß√µes de neg√≥cio ocorrem entre o DTO e Controller atrav√©s da anota√ß√£o `@Valid`

---

## 5. Requisitos Funcionais

| ID | Descri√ß√£o |
|----|-----------|
| RF01 | Cadastrar/excluir categorias (apenas id e nome). Exclus√£o bloqueada se houver lan√ßamentos vinculados |
| RF02 | Cadastrar/excluir lan√ßamentos (receitas e despesas). Edi√ß√£o n√£o permitida no MVP |
| RF03 | Selecionar recorr√™ncia fixa no lan√ßamento. Se diferente de `UNICA`, gerar automaticamente lan√ßamentos futuros |
| RF04 | Listar lan√ßamentos com filtros (per√≠odo, tipo, categoria) e pagina√ß√£o |
| RF05 | Visualizar relat√≥rios na interface web (sem exporta√ß√£o no MVP): Saldo no per√≠odo, Evolu√ß√£o mensal, Distribui√ß√£o por categoria |
| RF06 | Registrar metadados de auditoria m√≠nimos (criado_em, atualizado_em) |
| RF07 | Validar dados de entrada usando `@Valid` nos DTOs antes de processar no Controller |

---

## 6. Requisitos N√£o Funcionais

- **Arquitetura**: Spring Boot (REST), camadas controller ‚Üí dto ‚Üí service ‚Üí domain ‚Üí repository
- **Banco de Dados**: MySQL 8+ com Spring JPA (Hibernate), cria√ß√£o de tabelas a partir das entidades
- **Valida√ß√£o**: Uso obrigat√≥rio de anota√ß√µes `@Valid` nos DTOs para valida√ß√£o de entradas antes do processamento no Controller
- **Usabilidade**: Interface responsiva (Bootstrap), mobile first; acessibilidade b√°sica (aria-labels)
- **Ambiente**: Aplica√ß√£o rodando em localhost:8080 (back-end) e localhost:3000 (front-end)
- **Compatibilidade**: Navegadores Chrome/Firefox/Edge atuais
- **Separa√ß√£o de Responsabilidades**: Uso de DTOs para request/response, separados do modelo de dom√≠nio
- **Automa√ß√£o**: Job agendado para processar lan√ßamentos recorrentes (gerar lan√ßamentos futuros automaticamente)
- **Integridade Referencial**: Valida√ß√£o obrigat√≥ria antes de excluir categorias (verificar se h√° lan√ßamentos vinculados)

---

## 7. Diagramas UML

### 7.1 Diagrama de Casos de Uso

```plantuml
@startuml
!theme crt-green
left to right direction

actor "Usu√°rio" as User

rectangle "CashWise" {
  usecase "Gerenciar Categorias" as UC_Cat
  usecase "Registrar Lan√ßamento" as UC_Trans
  usecase "Excluir Lan√ßamento" as UC_Del
  usecase "Aplicar Filtros" as UC_Filter
  usecase "Visualizar Relat√≥rios" as UC_Report
}

User --> UC_Cat
User --> UC_Trans
User --> UC_Del
User --> UC_Filter
User --> UC_Report

UC_Trans .> UC_Filter : <<include>>
UC_Report .> UC_Filter : <<include>>

@enduml
```

### 7.2 Diagrama de Classes

```plantuml
@startuml
!theme crt-green
hide circle
skinparam packageStyle rectangle
skinparam linetype ortho

' === API LAYER ===
package "API" #1a1a1a {
  
  package "Controller" #2d2d2d {
    class CategoriaController {
      + cadastrar(request): ResponseEntity
      + listar(): ResponseEntity
      + excluir(id): ResponseEntity
    }
    
    class LancamentoController {
      + cadastrar(request): ResponseEntity
      + listar(filtro): ResponseEntity
      + excluir(id): ResponseEntity
    }
    
    class RelatorioController {
      + saldoPeriodo(inicio, fim): ResponseEntity
      + evolucaoMensal(ano): ResponseEntity
      + distribuicaoPorCategoria(inicio, fim): ResponseEntity
    }
  }
  
  package "DTO" #2d2d2d {
    class CategoriaRequest {
      - nome: String
      __valida√ß√µes__
      @NotBlank
      @Size(max=120)
    }
    
    class CategoriaResponse {
      - id: Long
      - nome: String
    }
    
    class LancamentoRequest {
      - tipo: String
      - categoriaId: Long
      - valor: BigDecimal
      - data: LocalDate
      - descricao: String
      - recorrencia: String
      __valida√ß√µes__
      @NotNull, @Positive
    }
    
    class LancamentoResponse {
      - id: Long
      - tipo: String
      - categoria: CategoriaResponse
      - valor: BigDecimal
      - data: LocalDate
      - descricao: String
      - recorrencia: String
    }
    
    class FiltroLancamentoRequest {
      - dataInicio: LocalDate
      - dataFim: LocalDate
      - tipo: String
      - categoriaId: Long
    }
  }
  
  package "Mapper" #2d2d2d {
    class CategoriaMapper <<@Component>> {
      + toEntity(request): Categoria
      + toResponse(entity): CategoriaResponse
    }
    
    class LancamentoMapper <<@Component>> {
      + toEntity(request): Lancamento
      + toResponse(entity): LancamentoResponse
    }
  }
}

' === DOMAIN LAYER ===
package "Dominio" #1a4d1a {
  
  class Categoria <<@Entity>> {
    - id: Long
    - nome: String
    - criadoEm: LocalDateTime
    - atualizadoEm: LocalDateTime
  }
  
  class Lancamento <<@Entity>> {
    - id: Long
    - tipo: TipoLancamento
    - valor: BigDecimal
    - data: LocalDate
    - descricao: String
    - recorrencia: TipoRecorrencia
    - categoria: Categoria
    - criadoEm: LocalDateTime
    + isReceita(): boolean
    + isDespesa(): boolean
  }
  
  enum TipoLancamento {
    RECEITA
    DESPESA
  }
  
  enum TipoRecorrencia {
    UNICA
    DIARIA
    SEMANAL
    MENSAL
    TRIMESTRAL
    ANUAL
  }
}

' === SERVICE LAYER ===
package "Servico" #4d4d1a {
  
  class CategoriaServico <<@Service>> {
    + cadastrar(categoria): Categoria
    + excluir(id): void
    + listar(): List<Categoria>
    - verificarVinculo(id): boolean
  }
  
  class LancamentoServico <<@Service>> {
    + cadastrar(lancamento): Lancamento
    + excluir(id): void
    + listar(filtro): Page<Lancamento>
    + gerarRecorrentes(): void
  }
  
  class RelatorioServico <<@Service>> {
    + calcularSaldo(inicio, fim): BigDecimal
    + distribuicaoPorCategoria(inicio, fim): Map
    + evolucaoMensal(ano): Map
  }
}

' === REPOSITORY LAYER ===
package "Repository" #1a1a4d {
  
  interface CategoriaRepository <<@Repository>> {
    + findAll(): List
    + save(entity): Categoria
    + deleteById(id): void
  }
  
  interface LancamentoRepository <<@Repository>> {
    + save(entity): Lancamento
    + deleteById(id): void
    + findAll(spec, page): Page
    + existsByCategoriaId(id): boolean
  }
}

' === JOB LAYER ===
package "Job" #4d1a1a {
  class RecorrenciaJob <<@Scheduled>> {
    - lancamentoServico
    + processar(): void
  }
}

' === RELACIONAMENTOS ===
Lancamento "N" --> "1" Categoria
Lancamento --> TipoLancamento
Lancamento --> TipoRecorrencia

CategoriaController ..> CategoriaServico
CategoriaController ..> CategoriaMapper
LancamentoController ..> LancamentoServico
LancamentoController ..> LancamentoMapper
RelatorioController ..> RelatorioServico

CategoriaMapper ..> Categoria
CategoriaMapper ..> CategoriaRequest
CategoriaMapper ..> CategoriaResponse
LancamentoMapper ..> Lancamento
LancamentoMapper ..> LancamentoRequest
LancamentoMapper ..> LancamentoResponse

CategoriaServico ..> CategoriaRepository
CategoriaServico ..> LancamentoRepository
LancamentoServico ..> LancamentoRepository
RelatorioServico ..> LancamentoRepository

RecorrenciaJob ..> LancamentoServico

@enduml
```

### 7.3 Diagrama EER

```plantuml
@startuml
!theme crt-green

entity "categoria" as CAT {
  * id: BIGINT <<PK>>
  --
  nome: VARCHAR(120) <<NOT NULL>>
  criado_em: DATETIME <<NOT NULL>>
  atualizado_em: DATETIME <<NOT NULL>>
}

entity "lancamento" as LAN {
  * id: BIGINT <<PK>>
  --
  categoria_id: BIGINT <<FK>> <<NOT NULL>>
  tipo: ENUM('RECEITA','DESPESA') <<NOT NULL>>
  recorrencia: ENUM('UNICA','DIARIA','SEMANAL','MENSAL','TRIMESTRAL','ANUAL') <<NOT NULL>>
  data: DATE <<NOT NULL>>
  valor: DECIMAL(15,2) <<NOT NULL>>
  descricao: VARCHAR(255) <<NOT NULL>>
  criado_em: DATETIME <<NOT NULL>>
  atualizado_em: DATETIME <<NOT NULL>>
}

CAT ||--o{ LAN : "classifica"

@enduml
```

**√çndices recomendados para `lancamento`**:
- `idx_lan_data` (data)
- `idx_lan_categoria` (categoria_id)
- `idx_lan_tipo` (tipo)
- `idx_lan_data_tipo` (data, tipo)

---

## 8. Estrutura de Pacotes

```
com.cashwise/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ controller/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CategoriaController.java
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LancamentoController.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ RelatorioController.java
‚îÇ   ‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ request/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CategoriaRequest.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LancamentoRequest.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ FiltroLancamentoRequest.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ response/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ CategoriaResponse.java
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ LancamentoResponse.java
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ RelatorioResponse.java
‚îÇ   ‚îî‚îÄ‚îÄ mapper/
‚îÇ       ‚îú‚îÄ‚îÄ CategoriaMapper.java
‚îÇ       ‚îî‚îÄ‚îÄ LancamentoMapper.java
‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îú‚îÄ‚îÄ entity/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Categoria.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Lancamento.java
‚îÇ   ‚îî‚îÄ‚îÄ enums/
‚îÇ       ‚îú‚îÄ‚îÄ TipoLancamento.java
‚îÇ       ‚îî‚îÄ‚îÄ TipoRecorrencia.java
‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îú‚îÄ‚îÄ CategoriaRepository.java
‚îÇ   ‚îî‚îÄ‚îÄ LancamentoRepository.java
‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îú‚îÄ‚îÄ CategoriaServico.java
‚îÇ   ‚îú‚îÄ‚îÄ LancamentoServico.java
‚îÇ   ‚îî‚îÄ‚îÄ RelatorioServico.java
‚îú‚îÄ‚îÄ job/
‚îÇ   ‚îî‚îÄ‚îÄ RecorrenciaJob.java
‚îî‚îÄ‚îÄ CashWiseApplication.java
```

---

## Conclus√£o

Esta documenta√ß√£o define o escopo do MVP da plataforma **CashWise**, um sistema de controle financeiro pessoal focado em simplicidade e usabilidade. O sistema permite gerenciar categorias, registrar lan√ßamentos com recorr√™ncia fixa e visualizar relat√≥rios financeiros de forma clara e objetiva.

### Princ√≠pios de Design

- **KISS** (Keep It Simple, Stupid): Modelo simplificado, sem complexidades desnecess√°rias
- **YAGNI** (You Aren't Gonna Need It): Apenas funcionalidades essenciais para o MVP
- **SOLID**: Principalmente SRP (Single Responsibility Principle) na separa√ß√£o de servi√ßos
- **Object Calisthenics**: Boas pr√°ticas de design orientado a objetos
- **DTO Pattern**: Separa√ß√£o clara entre API externa e modelo de dom√≠nio interno

### Benef√≠cios da Arquitetura

A arquitetura em camadas com DTOs espec√≠ficos proporciona:
- Desacoplamento entre API e dom√≠nio
- Valida√ß√£o espec√≠fica para entradas da API
- Flexibilidade para evolu√ß√£o do modelo de dom√≠nio sem impactar a API
- Seguran√ßa ao expor apenas os dados necess√°rios nas respostas
